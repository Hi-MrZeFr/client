(()=>{"use strict";var t={874:(t,n,e)=>{e.d(n,{Z:()=>d});var a=e(81),r=e.n(a),i=e(645),o=e.n(i)()(r());o.push([t.id,".detalk-container .input-data {\n\tdisplay: flex;\n\tflex-direction: row;\n}\n.detalk-container .avatar img {\n\tborder-radius: 6px;\n\tflex-shrink: 0;\n\theight: 2.5rem;\n\twidth: 2.5rem;\n\toverflow: hidden;\n\ttext-align: center;\n\tborder-radius: 5px;\n    user-select: none;\n}\n\n.detalk-container .input-data .input-area {\n\tflex: 1;\n\tdisplay: flex;\n\tflex-direction: column;\n\tmargin-left: 0.5rem;\n}\n\n.detalk-container .border_error {\n\tborder: 1px solid red!important;\n}\n.detalk-container .input-data .input-area input {\n\tmargin-bottom: 0.5rem;\n\tborder-top-left-radius: 0;\n\tborder-bottom-left-radius: 0;\n\theight: 32px;\n\tline-height: 32px;\n\tcolor: currentColor;\n\tbackground-color: transparent;\n\tborder-color: rgba(144, 147, 153, 0.31);\n\t-webkit-appearance: none;\n\tbackground-color: #fff;\n\tborder-radius: 4px;\n\tborder: 1px solid #dcdfe6;\n\tbox-sizing: border-box;\n\tcolor: rgba(0, 0, 0, 0.8);\n\tdisplay: inline-block;\n\theight: 40px;\n\tline-height: 40px;\n\toutline: 0;\n\tpadding: 0 15px;\n\ttransition: border-color 0.2s cubic-bezier(0.645, 0.045, 0.355, 1);\n\twidth: 100%;\n    font-family: monospace;\n}\n\n/* @media screen and (min-width: 568px) {\n    .detalk-container .input-data .input-area input {\n        width: 32%!important;\n    }\n    .detalk-container .input-data .input-area {\n        display: inline;\n    }\n    .detalk-container .input-data .input-area .mgr-2p {\n        margin-right: 1.5%;\n    }\n} */\n\n.detalk-container ::-webkit-scrollbar {\n    width: 1px;\n    height: 3px;\n}\n\n.detalk-container ::-webkit-scrollbar-thumb {\n    border-radius: 2px;\n    box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);\n    background: rgba(0, 0, 0, 0.2);\n}\n\n.detalk-container ::-webkit-scrollbar-track {\n    box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);\n    border-radius: 0;\n    background: rgba(0, 0, 0, 0.1);\n}\n\n.detalk-container .reply {\n\tdisplay: flex;\n}\n.detalk-container .input-data .input-area textarea {\n    margin-bottom: 0.5rem;\n\tborder-top-left-radius: 0;\n\tborder-bottom-left-radius: 0;\n\theight: 32px;\n\tcolor: currentColor;\n\tbackground-color: transparent;\n\tborder-color: rgba(144, 147, 153, 0.31);\n\t-webkit-appearance: none;\n\tbackground-color: #fff;\n\tborder-radius: 4px;\n\tborder: 1px solid #dcdfe6;\n\tbox-sizing: border-box;\n\tcolor: rgba(0, 0, 0, 0.8);\n\tdisplay: inline-block;\n\theight: 40px;\n\tline-height: 40px;\n\toutline: 0;\n\tpadding: 5px 15px;\n\ttransition: border-color 0.2s cubic-bezier(0.645, 0.045, 0.355, 1);\n\twidth: 100%;\n    resize: vertical;\n    font-family: monospace;\n    line-height: 1.2rem;\n}\n\n\n.detalk-container .action-btn-group {\n\tposition: relative;\n\tmargin-top: 0;\n\tmargin-bottom: 1rem;\n\tmargin-left: 3.5rem;\n\talign-items: center;\n\tjustify-content: flex-end;\n\tdisplay: flex;\n}\n\n.detalk-container .action-btn-group .action-btn .sec-btn {\n\tbackground-color: rgba(144, 147, 153, 0.063);\n\tborder-color: rgba(144, 147, 153, 0.31);\n    border-radius: 6px;\n}\n\n.detalk-container .action-btn-group .action-btn .word-limit {\n    text-align: end;\n    opacity: 0.7;\n    font-size: 0.9rem;\n    margin-right: 0.4rem;\n}\n.detalk-container .action-btn-group .action-btn .fst-btn.disabled {\n\tcolor: rgba(255, 255, 255, 0.8);\n\tbackground-color: rgba(64, 158, 255, 0.5);\n\tborder-color: transparent;\n    border-radius: 6px;\n    cursor: not-allowed;\n}\n\n.detalk-container .action-btn-group .action-btn .fst-btn.enabled {\n\tcolor: rgba(255, 255, 255, 1);\n\tbackground-color: rgba(64, 158, 255, 1);\n\tborder-color: transparent;\n    border-radius: 6px;\n    cursor: pointer;\n}\n\n.detalk-container .cm-btn {\n\tpadding: 9px 15px;\n\tfont-size: 12px;\n\tborder-radius: 3px;\n\tdisplay: inline-block;\n\tline-height: 1;\n\twhite-space: nowrap;\n\tcursor: pointer;\n\tbackground: #fff;\n\tborder: 1px solid #dcdfe6;\n\tcolor: #606266;\n\t-webkit-appearance: none;\n\ttext-align: center;\n\t-webkit-box-sizing: border-box;\n\tbox-sizing: border-box;\n\toutline: 0;\n\tmargin: 0;\n\t-webkit-transition: 0.1s;\n\ttransition: 0.1s;\n\tfont-weight: 500;\n    user-select: none;\n\tpadding: 12px 20px;\n\tfont-size: 14px;\n\tborder-radius: 4px;\n}\n\n.detalk-container .mr-cmt {\n\tmargin-top: 1rem;\n\tdisplay: flex;\n\tflex-direction: row;\n\tword-break: break-all;\n    padding: 10px;\n    border-radius: 6px;\n    transition: all .3s;\n}\n.detalk-container .mr-cmt:hover {\n    background: rgba(0, 0, 0, 0.05);\n    cursor: pointer;\n}\n\n.detalk-container .mr-cmt .cmt-main {\n\tmargin-left: 1rem;\n\tflex: 1;\n\twidth: 0;\n}\n\n.detalk-container .mr-cmt .cmt-main .cmt-data {\n\tflex: 1;\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n    user-select: none;\n}\n\n.detalk-container .mr-cmt .cmt-main .cmt-content {\n    margin-top: 0.3rem;\n\topacity: 0.8;\n}\n\n.comment-container._detalk_loading_container {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    margin-top: 45px;\n}\n",""]);const d=o},645:t=>{t.exports=function(t){var n=[];return n.toString=function(){return this.map((function(n){var e="",a=void 0!==n[5];return n[4]&&(e+="@supports (".concat(n[4],") {")),n[2]&&(e+="@media ".concat(n[2]," {")),a&&(e+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),e+=t(n),a&&(e+="}"),n[2]&&(e+="}"),n[4]&&(e+="}"),e})).join("")},n.i=function(t,e,a,r,i){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(a)for(var d=0;d<this.length;d++){var l=this[d][0];null!=l&&(o[l]=!0)}for(var c=0;c<t.length;c++){var s=[].concat(t[c]);a&&o[s[0]]||(void 0!==i&&(void 0===s[5]||(s[1]="@layer".concat(s[5].length>0?" ".concat(s[5]):""," {").concat(s[1],"}")),s[5]=i),e&&(s[2]?(s[1]="@media ".concat(s[2]," {").concat(s[1],"}"),s[2]=e):s[2]=e),r&&(s[4]?(s[1]="@supports (".concat(s[4],") {").concat(s[1],"}"),s[4]=r):s[4]="".concat(r)),n.push(s))}},n}},81:t=>{t.exports=function(t){return t[1]}},379:t=>{var n=[];function e(t){for(var e=-1,a=0;a<n.length;a++)if(n[a].identifier===t){e=a;break}return e}function a(t,a){for(var i={},o=[],d=0;d<t.length;d++){var l=t[d],c=a.base?l[0]+a.base:l[0],s=i[c]||0,u="".concat(c," ").concat(s);i[c]=s+1;var m=e(u),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==m)n[m].references++,n[m].updater(p);else{var b=r(p,a);a.byIndex=d,n.splice(d,0,{identifier:u,updater:b,references:1})}o.push(u)}return o}function r(t,n){var e=n.domAPI(n);return e.update(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap&&n.supports===t.supports&&n.layer===t.layer)return;e.update(t=n)}else e.remove()}}t.exports=function(t,r){var i=a(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<i.length;o++){var d=e(i[o]);n[d].references--}for(var l=a(t,r),c=0;c<i.length;c++){var s=e(i[c]);0===n[s].references&&(n[s].updater(),n.splice(s,1))}i=l}}},569:t=>{var n={};t.exports=function(t,e){var a=function(t){if(void 0===n[t]){var e=document.querySelector(t);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}n[t]=e}return n[t]}(t);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}},216:t=>{t.exports=function(t){var n=document.createElement("style");return t.setAttributes(n,t.attributes),t.insert(n,t.options),n}},565:(t,n,e)=>{t.exports=function(t){var n=e.nc;n&&t.setAttribute("nonce",n)}},795:t=>{t.exports=function(t){var n=t.insertStyleElement(t);return{update:function(e){!function(t,n,e){var a="";e.supports&&(a+="@supports (".concat(e.supports,") {")),e.media&&(a+="@media ".concat(e.media," {"));var r=void 0!==e.layer;r&&(a+="@layer".concat(e.layer.length>0?" ".concat(e.layer):""," {")),a+=e.css,r&&(a+="}"),e.media&&(a+="}"),e.supports&&(a+="}");var i=e.sourceMap;i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),n.styleTagTransform(a,t,n.options)}(n,t,e)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)}}}},589:t=>{t.exports=function(t,n){if(n.styleSheet)n.styleSheet.cssText=t;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(t))}}}},n={};function e(a){var r=n[a];if(void 0!==r)return r.exports;var i=n[a]={id:a,exports:{}};return t[a](i,i.exports,e),i.exports}e.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},e.d=(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},e.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),e.nc=void 0,(()=>{var t=e(379),n=e.n(t),a=e(795),r=e.n(a),i=e(569),o=e.n(i),d=e(565),l=e.n(d),c=e(216),s=e.n(c),u=e(589),m=e.n(u),p=e(874),b={};async function g(t,n){document.getElementById("_detalk_detail").classList.add("_detalk_loading_container"),document.getElementById("_detalk_detail").innerHTML='<svg width="30px" height="30px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">\n    <g>\n        <animateTransform attributeName="transform" type="rotate" values="0 33 33;270 33 33" begin="0s" dur="1.4s" fill="freeze" repeatCount="indefinite"></animateTransform>\n        <circle fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30" stroke-dasharray="187" stroke-dashoffset="610">\n            <animate attributeName="stroke" values="#4285F4;#DE3E35;#F7C223;#1B9A59;#4285F4" begin="0s" dur="5.6s" fill="freeze" repeatCount="indefinite"></animate>\n            <animateTransform attributeName="transform" type="rotate" values="0 33 33;135 33 33;450 33 33" begin="0s" dur="1.4s" fill="freeze" repeatCount="indefinite"></animateTransform>\n            <animate attributeName="stroke-dashoffset" values="187;46.75;187" begin="0s" dur="1.4s" fill="freeze" repeatCount="indefinite"></animate>\n        </circle>\n    </g>\n    </svg>';let e=await fetch(t+"/_api/comment?id="+n,{method:"GET"}).then((t=>t.json()));e=e.value;let a=0,r=[];for(let t in e)e[t].deleted||(a++,r.push(e[t]));document.getElementById("_detalk_detail").innerHTML=function(t,n){let e="";for(let t in n){let a="";if(n[t].replies){a+="<hr/>";for(let e of n[t].replies)e.deleted||(a+=`\n                    <div class="reply">\n                        <div class="avatar">\n                            <img src="${e.avatar||"https://cravatar.cn/avatar/?d=mp"}" class="avatar-img">\n                        </div>\n                        <div class="cmt-main" style="display: inline;">\n                            <div class="cmt-data">\n                                <span><strong>${e.nickname}</strong></span>\n                            </div>\n                            <div class="cmt-content">\n                                ${e.content}\n                            </div>\n                        </div>\n                    </div>`)}e+=`\n            <div class="mr-cmt" onclick="detalk.reply('${n[t].rpid}', '${n[t].nickname}')">\n                <div class="avatar">\n                    <img src="${n[t].avatar||"https://cravatar.cn/avatar/?d=mp"}" class="avatar-img">\n                </div>\n                <div class="cmt-main">\n                    <div class="cmt-data">\n                        <span><strong>${n[t].nickname}</strong></span>\n                    </div>\n                    <div class="cmt-content">\n                        ${n[t].content}\n                    </div>\n                    <div class="replies">\n                        ${a}\n                    </div>\n                </div>\n            </div>`}return`\n    <div class="comment-title">\n        <h3>共 ${t} 条评论</h3>\n    </div>\n    <div class="comment-list">\n        ${e}\n    </div>\n    `}(a,r),document.getElementById("_detalk_detail").classList.remove("_detalk_loading_container")}b.styleTagTransform=m(),b.setAttributes=l(),b.insert=o().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=s(),n()(p.Z,b),p.Z&&p.Z.locals&&p.Z.locals,window.detalk={init:async function(t={}){if(window.DETALK_INIT=t,!t.url)throw new Error("Backend URL is required!");let n=new URL(t.url).protocol+"//"+new URL(t.url).host,e=document.querySelector(t.el),a=t.path;if(!e)throw new Error("Element is required!");return a||(a=window.DETALK_PATH||window.location.pathname),e.innerHTML='\n<div class="input-data">\n    <div class="avatar">\n        <img src="https://cravatar.cn/avatar/45ead422ade450468bc1d3c8fb543a4?d=mp" class="avatar-img">\n    </div>\n    <div class="input-area">\n        <div class="inline-input">\n            <input id="detalk_input_nickname" placeholder="昵称" type="text" class="mgr-2p" oninput="detalk.oninput(this, \'nickname\')">\n            <input id="detalk_input_email" placeholder="邮箱" type="email" class="mgr-2p" oninput="detalk.oninput(this, \'email\')">\n            <input id="detalk_input_link" placeholder="网址" type="url" oninput="detalk.oninput(this, \'link\')">\n        </div>\n        <div class="comment-text">\n            <textarea oninput="detalk.oninput(this, \'content\')" autocomplete="off" placeholder="" maxlength="500" style="min-height: 75px; height: 75px;" id="detalk_input_content"></textarea>\n        </div>\n    </div>\n\n</div>\n<div class="action-btn-group">\n    <div class="action-btn">\n        <p class="word-limit"><span id="_detalk_word_limit">0</span> / 500</p>\n        <button class="sec-btn cm-btn" id="_detalk_preview">预览</button>\n        <button onclick="detalk.send();" class="fst-btn cm-btn disabled" id="_detalk_submit">发送</button>\n    </div>\n</div>\n\n<div class="comment-container _detalk_loading_container" id="_detalk_detail">\n</div>\n',e.classList.add("detalk-container"),g(n,a),!0},send:async function(t,n){document.getElementById("_detalk_submit").disabled=!0,document.getElementById("_detalk_submit").classList.add("disabled"),document.getElementById("_detalk_submit").classList.remove("enabled"),t||(t=window.DETALK_INIT);let e=new URL(t.url).protocol+"//"+new URL(t.url).host,a=(document.querySelector(t.el),t.path),r=document.getElementById("detalk_input_nickname").value,i=document.getElementById("detalk_input_email").value,o=document.getElementById("detalk_input_link").value,d=document.getElementById("detalk_input_content").value;if(!r||!i||!d||r.length>=15||d.length>=500||i.length>=50||o.length>=100)return!1;localStorage.setItem("DETALK_NICKNAME",r),localStorage.setItem("DETALK_EMAIL",i),o.startsWith("#ReplyTo:")||localStorage.setItem("DETALK_LINK",o);let l=await fetch(e+"/_api/comment",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({nickname:r,email:i,id:a,url:o,replyTo:n||null,content:d})}).then((t=>t.json()));l.success?g(e,a):alert(l.message),document.getElementById("_detalk_submit").disabled=!1,document.getElementById("_detalk_submit").classList.remove("disabled"),document.getElementById("_detalk_submit").classList.add("enabled"),n&&l.success&&(document.getElementById("detalk_input_content").value="",document.getElementById("_detalk_submit").setAttribute("onclick","detalk.send(null)"),document.getElementById("_detalk_submit").innerText="发送",document.getElementById("_detalk_preview").innerText="预览",document.getElementById("_detalk_preview").setAttribute("onclick","detalk.preview()"))},reply:async function(t,n){if(!t)return!1;location.hash="#detalk_input_content",document.getElementById("detalk_input_content").value=`回复 @${n}: `,document.getElementById("detalk_input_content").focus(),document.getElementById("detalk_input_link").value=`#ReplyTo:${t}`,document.getElementById("_detalk_submit").setAttribute("onclick",`detalk.send(null, '${t}')`),document.getElementById("_detalk_submit").innerText="回复",document.getElementById("_detalk_preview").innerText="取消",document.getElementById("_detalk_preview").setAttribute("onclick",'document.getElementById("detalk_input_link").value="";detalk.send(null);document.getElementById("_detalk_submit").innerText="发送";document.getElementById("_detalk_preview").innerText="预览";document.getElementById("_detalk_preview").setAttribute("onclick", "detalk.preview()");')},load:g,oninput:function(t,n){"content"==n&&(document.getElementById("_detalk_word_limit").innerText=t.value.length,t.value.length>0&&t.value.length<500?(t.classList.remove("border_error"),window.TEMP_CONTENT=!0):t.classList.add("border_error")),"nickname"==n&&(document.getElementById("_detalk_word_limit").innerText=t.value.length,t.value.length>0&&t.value.length<15?(t.classList.remove("border_error"),window.TEMP_NICKNAME=!0):t.classList.add("border_error")),"email"==n&&(!t.value.match(/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/)||t.value.length>50?t.classList.add("border_error"):(t.classList.remove("border_error"),window.TEMP_EMAIL=!0)),"link"==n&&(t.value.length>100?t.classList.add("border_error"):t.classList.remove("border_error")),window.TEMP_NICKNAME&&window.TEMP_EMAIL&&window.TEMP_CONTENT?(document.getElementById("_detalk_submit").classList.remove("disabled"),document.getElementById("_detalk_submit").classList.add("enabled")):(document.getElementById("_detalk_submit").classList.remove("enabled"),document.getElementById("_detalk_submit").classList.add("disabled"))}}})()})();